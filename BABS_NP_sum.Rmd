---
title: "BABS Neuropsych Summary"
author: "JLC"
date: "`r Sys.Date()`"
output: 
  html_document:
    code_folding: hide
---
# Brandeis Aging Brain Study (BABS) Neuropsych Battery: Descriptive Summary

```{r setup, warning=FALSE, message=FALSE}
rm(list=ls())

# Packages
library(knitr); library(kableExtra); library(RColorBrewer); library(correlation); library(readxl); library(tidyverse)

#Create data directories
NP.path<-"/Volumes/berry-lab/berry-lab/Brandeis_Aging_Brain_Study/BABS Data/Analysis/BABS NP MASTER.xlsx"

#Make data frames for neuropsych battery items from excel spreadsheet
BABS.NP.demo <- read_xlsx(NP.path, sheet = "Demographics")
BABS.NP.sess1 <- read_xlsx(NP.path, sheet = "Session 1")
```

# Behavioral Measures {.tabset}
## General Cognitive Function {.tabset}

### MMSE

```{r MMSE, warning=FALSE, message=FALSE}
#creating data frame with relevant variables
d.MMSE <- BABS.NP.sess1 %>% select(BABS_ID, `AGE AT SESSION`, MMSE) %>% distinct(BABS_ID, .keep_all = T)
#counting the number of observations and summarizing mean & SD
MMSE.sum <- d.MMSE %>% summarise(count.MMSE = sum(!is.na(MMSE)),
         mean.MMSE = mean(MMSE, na.rm=T),
         SD.MMSE = sd(MMSE, na.rm=T))
kable(MMSE.sum, col.names = c("Count","Mean", "SD"),
      caption = "MMSE Summary Table") %>% kable_styling()
#plotting distribution of scores
p.MMSE <- ggplot(d.MMSE, aes(MMSE)) +
  geom_bar() + scale_x_continuous(limits = c(20,31), breaks = seq(20,30,1)) +
  labs(title = "MMSE Scores in BABS Sample") +
  theme_classic()
p.MMSE
```

## Working Memory {.tabset}
### Digit Span
#### Forward
Note: BABS_259 has forward value of "8 or 7"; presently excluded for being non-numeric. Verify actual score.

```{r DigSpan_for, warning=FALSE, message=FALSE}
#creating data frame with relevant variables
d.DigSpan.F <- BABS.NP.sess1 %>% select(BABS_ID, `AGE AT SESSION`, DIGITSPAN_FORWARD) %>%
                                          distinct(BABS_ID, .keep_all = T)
d.DigSpan.F$DIGITSPAN_FORWARD <- as.numeric(d.DigSpan.F$DIGITSPAN_FORWARD)
#counting the number of observations and summarizing mean & SD
DigSpan.F.sum <- d.DigSpan.F %>% summarise(count.Forward.DigSpan = sum(!is.na(DIGITSPAN_FORWARD)),
         mean.Forward.DigSpan = mean(DIGITSPAN_FORWARD, na.rm=T),
         SD.Forward.DigSpan = sd(DIGITSPAN_FORWARD, na.rm=T))
kable(DigSpan.F.sum, col.names = c("Count","Mean", "SD"),
      caption = "Forward Digit Span Summary Table") %>% kable_styling()
#plotting distribution of scores
p.DigSpan.F <- ggplot(d.DigSpan.F, aes(DIGITSPAN_FORWARD)) +
  geom_bar() + scale_x_continuous(limits = c(2,15), breaks = seq(2,14,1)) +
  labs(title = "Forward Digit Span Scores in BABS Sample") +
  theme_classic()
p.DigSpan.F
```

#### Backward
Note: BABS_220 has value of "71"; BABS_139 has score of 19; BABS_280 has score of 16. Verify actual scores. Digit span I have used in the past has a max score of 14/domain; double-check range used in BABS.
Also, there are currently a different number of observations for forward and backward scores, which needs to be investigated.

```{r DigSpan_back, warning=FALSE, message=FALSE}
#creating data frame with relevant variables
d.DigSpan.B <- BABS.NP.sess1 %>% select(BABS_ID, `AGE AT SESSION`, DIGITSPAN_BACKWARD) %>%
                                          distinct(BABS_ID, .keep_all = T)
d.DigSpan.B$DIGITSPAN_BACKWARD <- as.numeric(d.DigSpan.B$DIGITSPAN_BACKWARD)
#counting the number of observations and summarizing mean & SD
DigSpan.B.sum <- d.DigSpan.B %>% summarise(count.Backward.DigSpan = sum(!is.na(DIGITSPAN_BACKWARD)),
         mean.Backward.DigSpan = mean(DIGITSPAN_BACKWARD, na.rm=T),
         SD.Backward.DigSpan = sd(DIGITSPAN_BACKWARD, na.rm=T))
kable(DigSpan.B.sum, col.names = c("Count","Mean", "SD"),
      caption = "Backward Digit Span Summary Table") %>% kable_styling()
#plotting distribution of scores
p.DigSpan.B <- ggplot(d.DigSpan.B, aes(DIGITSPAN_BACKWARD)) +
  geom_bar() + scale_x_continuous(limits = c(2,15), breaks = seq(2,14,1)) +
  labs(title = "Backward Digit Span Scores in BABS Sample") +
  theme_classic()
p.DigSpan.B
```

### Keep Track Task
Note: Will need to verify what happened here; early Ss have 1 (not 4) category, but later have 4 (not 1).

```{r KeepTrack, warning=FALSE, message=FALSE}
#creating data frame with relevant variables
d.KeepTrack <- BABS.NP.sess1 %>% select(BABS_ID, `AGE AT SESSION`, KEEPTRACK_ONECATEGORY_TOTAL, KEEPTRACK_TWOCATEGORIES_TOTAL, KEEPTRACK_FOURCATEGORIES_TOTAL) %>%
                                          distinct(BABS_ID, .keep_all = T)
#changing observed values to numeric values
d.KeepTrack$KEEPTRACK_ONECATEGORY_TOTAL <- as.numeric(d.KeepTrack$KEEPTRACK_ONECATEGORY_TOTAL)
d.KeepTrack$KEEPTRACK_TWOCATEGORIES_TOTAL <- as.numeric(d.KeepTrack$KEEPTRACK_TWOCATEGORIES_TOTAL)
d.KeepTrack$KEEPTRACK_FOURCATEGORIES_TOTAL <- as.numeric(d.KeepTrack$KEEPTRACK_FOURCATEGORIES_TOTAL)
#counting the number of observations and summarizing mean & SD
Keep.Track.sum <- d.KeepTrack %>% summarise(count.1Categ = sum(!is.na(KEEPTRACK_ONECATEGORY_TOTAL)),
         mean.1Categ = mean(KEEPTRACK_ONECATEGORY_TOTAL, na.rm=T),
         SD.1Categ = sd(KEEPTRACK_ONECATEGORY_TOTAL, na.rm=T),
         count.2Categ = sum(!is.na(KEEPTRACK_TWOCATEGORIES_TOTAL)),
         mean.2Categ = mean(KEEPTRACK_TWOCATEGORIES_TOTAL, na.rm=T),
         SD.2Categ = sd(KEEPTRACK_TWOCATEGORIES_TOTAL, na.rm=T),
         count.4Categ = sum(!is.na(KEEPTRACK_FOURCATEGORIES_TOTAL)),
         mean.4Categ = mean(KEEPTRACK_FOURCATEGORIES_TOTAL, na.rm=T),
         SD.4Categ = sd(KEEPTRACK_FOURCATEGORIES_TOTAL, na.rm=T),)
kable(Keep.Track.sum, col.names = c("Count: 1 Category","Mean: 1 Category", "SD: 1 Category", 
                                    "Count: 2 Category","Mean: 2 Category", "SD: 2 Category",
                                    "Count: 4 Category","Mean: 4 Category", "SD: 4 Category"),
      caption = "Keep Track Summary Table") %>% kable_styling()
#creating long data frame
d.KeepTrack.long <- d.KeepTrack %>% 
  pivot_longer(names_to = "Level", values_to = "Score", -c(BABS_ID, `AGE AT SESSION`))
d.KeepTrack.long$Level <- factor(d.KeepTrack.long$Level, levels = c("KEEPTRACK_ONECATEGORY_TOTAL","KEEPTRACK_TWOCATEGORIES_TOTAL","KEEPTRACK_FOURCATEGORIES_TOTAL"), 
                                 labels = c(1,2,4))
#plotting distribution of scores
p.KeepTrack <- ggplot(d.KeepTrack.long, aes(Score)) +
  geom_bar() + 
  labs(title = "Keep Track Scores in BABS Sample") +
  theme_classic() + facet_grid(.~Level)
p.KeepTrack
```

### Spatial N-Back

```{r NBack, warning=FALSE, message=FALSE}




```

## Inhibition {.tabset}
### Stroop (Paper version)
Note: Verify that this is only part of the later battery (i.e., only later Ss have these values).

```{r Stroop_paper, warning=FALSE, message=FALSE}
#creating data frame with relevant variables
d.Stroop.paper <- BABS.NP.sess1 %>% select(BABS_ID, `AGE AT SESSION`, STROOP_WORD_CORRECT,
                                           STROOP_COLOR_INCORRECT, STROOP_COLOR_CORRECT, STROOP_COLOR_INCORRECT,
                                           STROOP_COLORWORD_CORRECT, STROOP_COLORWORD_INCORRECT) %>%
                                          distinct(BABS_ID, .keep_all = T)
#changing observed values to numeric values
d.KeepTrack$KEEPTRACK_ONECATEGORY_TOTAL <- as.numeric(d.KeepTrack$KEEPTRACK_ONECATEGORY_TOTAL)
d.KeepTrack$KEEPTRACK_TWOCATEGORIES_TOTAL <- as.numeric(d.KeepTrack$KEEPTRACK_TWOCATEGORIES_TOTAL)
d.KeepTrack$KEEPTRACK_FOURCATEGORIES_TOTAL <- as.numeric(d.KeepTrack$KEEPTRACK_FOURCATEGORIES_TOTAL)
#counting the number of observations and summarizing mean & SD
Keep.Track.sum <- d.KeepTrack %>% summarise(count.1Categ = sum(!is.na(KEEPTRACK_ONECATEGORY_TOTAL)),
         mean.1Categ = mean(KEEPTRACK_ONECATEGORY_TOTAL, na.rm=T),
         SD.1Categ = sd(KEEPTRACK_ONECATEGORY_TOTAL, na.rm=T),
         count.2Categ = sum(!is.na(KEEPTRACK_TWOCATEGORIES_TOTAL)),
         mean.2Categ = mean(KEEPTRACK_TWOCATEGORIES_TOTAL, na.rm=T),
         SD.2Categ = sd(KEEPTRACK_TWOCATEGORIES_TOTAL, na.rm=T),
         count.4Categ = sum(!is.na(KEEPTRACK_FOURCATEGORIES_TOTAL)),
         mean.4Categ = mean(KEEPTRACK_FOURCATEGORIES_TOTAL, na.rm=T),
         SD.4Categ = sd(KEEPTRACK_FOURCATEGORIES_TOTAL, na.rm=T),)
Keep.Track.sum
#creating long data frame
d.KeepTrack.long <- d.KeepTrack %>% 
  pivot_longer(names_to = "Level", values_to = "Score", -c(BABS_ID, `AGE AT SESSION`))
d.KeepTrack.long$Level <- factor(d.KeepTrack.long$Level, levels = c("KEEPTRACK_ONECATEGORY_TOTAL","KEEPTRACK_TWOCATEGORIES_TOTAL","KEEPTRACK_FOURCATEGORIES_TOTAL"), 
                                 labels = c(1,2,4))
#plotting distribution of scores
p.KeepTrack <- ggplot(d.KeepTrack.long, aes(Score)) +
  geom_bar() + 
  labs(title = "Keep Track Scores in BABS Sample") +
  theme_classic() + facet_grid(.~Level)
p.KeepTrack
```

### Stroop (Computer version)

```{r Stroop_comp, warning=FALSE, message=FALSE}




```

### NIH Toolbox: Flanker

```{r Flanker, warning=FALSE, message=FALSE}




```

## Cognitive Flexibility {.tabset}
### NIH Toolbox: Dimensional Change Card Sort (DCCS)

```{r DCCS, warning=FALSE, message=FALSE}




```

### Cognitive Reflection Test

```{r CogReflect, warning=FALSE, message=FALSE}




```

## Learning and Memory {.tabset}
### California Verbal Learning Test (CVLT)

```{r CVLT, warning=FALSE, message=FALSE}




```

### Face-Name Associative Memory Examination (FNAME)

```{r FNAME, warning=FALSE, message=FALSE}




```

## Visuospatial {.tabset}
### Visual Reproduction

```{r VisRepro, warning=FALSE, message=FALSE}




```

## Fluid Intelligence {.tabset}
### WASI-II Matrix Reasoning
Note: Missing scores for most participants after BABS_200; is this measure still being collected? Also, need to look up the range of acceptable scores to verify values.

```{r MatrixReason, warning=FALSE, message=FALSE}
d.matrix <- BABS.NP.sess1 %>% select(BABS_ID, `AGE AT SESSION`, WASI_MATRIX_SCORE) %>%
                                          distinct(BABS_ID, .keep_all = T)
d.matrix$WASI_MATRIX_SCORE <- as.numeric(d.matrix$WASI_MATRIX_SCORE)
#counting the number of observations and summarizing mean & SD
Matrix.sum <- d.matrix %>% summarise(count = sum(!is.na(WASI_MATRIX_SCORE)),
         range = range(WASI_MATRIX_SCORE, na.rm = T),                       
         mean = mean(WASI_MATRIX_SCORE, na.rm=T),
         SD = sd(WASI_MATRIX_SCORE, na.rm=T))
kable(Matrix.sum, col.names = c("Count", "Range", "Mean", "SD"),
      caption = "WASI Matrix Reasoning Summary Table") %>% kable_styling()
#plotting distribution of scores
p.matrix <- ggplot(d.matrix, aes(WASI_MATRIX_SCORE)) +
  geom_bar() + 
  labs(title = "WASI Matrix Reasoning Scores in BABS Sample") +
  theme_classic()
p.matrix
```

## Creativity {.tabset}
### Remote Associates Test
Note: Stopped administration after BABS_173. All values fall in allowable range (0-12).

```{r RemoteAssoc, warning=FALSE, message=FALSE}
d.remoteAssoc <- BABS.NP.sess1 %>% select(BABS_ID, `AGE AT SESSION`, REMOTE_ASSOCIATES) %>%
                                          distinct(BABS_ID, .keep_all = T)
d.remoteAssoc$REMOTE_ASSOCIATES <- as.numeric(d.remoteAssoc$REMOTE_ASSOCIATES)
#counting the number of observations and summarizing mean & SD
remoteAssoc.sum <- d.remoteAssoc %>% summarise(count = sum(!is.na(REMOTE_ASSOCIATES)),
         range = range(REMOTE_ASSOCIATES, na.rm = T),                       
         mean = mean(REMOTE_ASSOCIATES, na.rm=T),
         SD = sd(REMOTE_ASSOCIATES, na.rm=T))
kable(remoteAssoc.sum, col.names = c("Count", "Range", "Mean", "SD"),
      caption = "Remote Associates Summary Table") %>% kable_styling()
#plotting distribution of scores
p.remoteAssoc <- ggplot(d.remoteAssoc, aes(REMOTE_ASSOCIATES)) +
  geom_bar() + 
  labs(title = "Remote Associates Scores in BABS Sample") +
  theme_classic()
p.remoteAssoc
```

### Alternative Uses Task
Note: There are only 4 observations of this in the entire battery contained within the sheet.

```{r AltUse, warning=FALSE, message=FALSE}
d.altUse <- BABS.NP.sess1 %>% select(BABS_ID, `AGE AT SESSION`, ALTERTIVE_USES) %>%
                                          distinct(BABS_ID, .keep_all = T)
d.altUse$ALTERTIVE_USES <- as.numeric(d.altUse$ALTERTIVE_USES)
#counting the number of observations and summarizing mean & SD
altUse.sum <- d.altUse %>% summarise(count = sum(!is.na(ALTERTIVE_USES)),
         range = range(ALTERTIVE_USES, na.rm = T),                       
         mean = mean(ALTERTIVE_USES, na.rm=T),
         SD = sd(ALTERTIVE_USES, na.rm=T))
kable(altUse.sum, col.names = c("Count", "Range", "Mean", "SD"),
      caption = "Alternative Uses Task Summary Table") %>% kable_styling()
#plotting distribution of scores
p.altUse <- ggplot(d.altUse, aes(ALTERTIVE_USES)) +
  geom_bar() + 
  labs(title = "Alternative Uses Scores in BABS Sample") +
  theme_classic()
p.altUse
```

## Crystalized Intelligence {.tabset}
### WASI-II Vocab
Note: Missing scores for most participants after BABS_200; is this measure still being collected? Also, need to look up the range of acceptable scores to verify values.

```{r WASI_vocab, warning=FALSE, message=FALSE}
#creating data frame with relevant variables
d.vocab <- BABS.NP.sess1 %>% select(BABS_ID, `AGE AT SESSION`, WASI_VOCAB_SCORE) %>%
                                          distinct(BABS_ID, .keep_all = T)
d.vocab$WASI_VOCAB_SCORE <- as.numeric(d.vocab$WASI_VOCAB_SCORE)
#counting the number of observations and summarizing mean & SD
Vocab.sum <- d.vocab %>% summarise(count = sum(!is.na(WASI_VOCAB_SCORE)),
         range = range(WASI_VOCAB_SCORE, na.rm = T),                       
         mean = mean(WASI_VOCAB_SCORE, na.rm=T),
         SD = sd(WASI_VOCAB_SCORE, na.rm=T))
kable(Vocab.sum, col.names = c("Count", "Range", "Mean", "SD"),
      caption = "WASI Vocab Summary Table") %>% kable_styling()
#plotting distribution of scores
p.vocab <- ggplot(d.vocab, aes(WASI_VOCAB_SCORE)) +
  geom_bar() + 
  labs(title = "WASI Vocab Scores in BABS Sample") +
  theme_classic()
p.vocab
```

### C-Test
Note: Stopped administration after BABS_173. Unknown range of acceptable values.

```{r CTest, warning=FALSE, message=FALSE}
#creating data frame with relevant variables
d.cTest <- BABS.NP.sess1 %>% select(BABS_ID, `AGE AT SESSION`, CTEST) %>%
                                          distinct(BABS_ID, .keep_all = T)
d.cTest$CTEST <- as.numeric(d.cTest$CTEST)
#counting the number of observations and summarizing mean & SD
cTest.sum <- d.cTest %>% summarise(count = sum(!is.na(CTEST)),
         range = range(CTEST, na.rm = T),                       
         mean = mean(CTEST, na.rm=T),
         SD = sd(CTEST, na.rm=T))
kable(cTest.sum, col.names = c("Count", "Range", "Mean", "SD"),
      caption = "C-Test Summary Table") %>% kable_styling()
#plotting distribution of scores
p.cTest <- ggplot(d.cTest, aes(CTEST)) +
  geom_bar() + 
  labs(title = "C-Test Scores in BABS Sample") +
  theme_classic()
p.cTest
```

# Individual Difference Questionnaires {.tabset}
## Lifestyle {.tabset}
### Lifetime Experiences Questionnaire (LEQ)

```{r LEQ, warning=FALSE, message=FALSE}




```

### BABS Physical Activities Questionnaire

```{r PhysActivity, warning=FALSE, message=FALSE}




```

## Depressive and Anxious Traits {.tabset}
### Geriatric Depression Questionnaire (GDS)

```{r GDS, warning=FALSE, message=FALSE}




```

### Mood and Anxiety Symptom Questionnaire (MASQ-30)

```{r MASQ, warning=FALSE, message=FALSE}




```

### Penn State Worry Questionnaire

```{r PSWQ, warning=FALSE, message=FALSE}




```

## Sleep {.tabset}
### Pittsburgh Sleep Quality Index (PSQI)

```{r PSQI, warning=FALSE, message=FALSE}




```

### Berkeley Retrospective Sleep Questionnaire (BRSQ)

```{r BRSQ, warning=FALSE, message=FALSE}




```

## Meta-cognition {.tabset}
### Multifactorial Memory Questionnaire

```{r MMQ, warning=FALSE, message=FALSE}




```

### Metamemory Questionnaire for Older Adults

```{r OA_Metamemory, warning=FALSE, message=FALSE}




```

### Behavior Rating Inventory of Executive Function-Adult (BRIEF-A)

```{r Brief_A, warning=FALSE, message=FALSE}




```

## Motivation {.tabset}
### Selection-Optimization-Compensation Questionnaire (SOCQ)

```{r SOCQ, warning=FALSE, message=FALSE}




```

### BIS/BAS

```{r BISBAS, warning=FALSE, message=FALSE}




```

### Barratt Impulsiveness Scale (BIS-11)

```{r BIS, warning=FALSE, message=FALSE}




```

### Grit Scale

```{r Grit, warning=FALSE, message=FALSE}




```

### Zimbardo Time Perspective Scale

```{r ZTPS, warning=FALSE, message=FALSE}




```

## Misc {.tabset}
### UCSF Early Developmental History Form

```{r UCSF_Dev, warning=FALSE, message=FALSE}




```